<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Client Basics and Login System part 1 | EmbeddedFPSExample</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/EmbeddedFPSExample/assets/css/0.styles.7db95943.css" as="style"><link rel="preload" href="/EmbeddedFPSExample/assets/js/app.c192a5b8.js" as="script"><link rel="preload" href="/EmbeddedFPSExample/assets/js/5.8d4560b8.js" as="script"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/10.d6c42d6a.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/11.8cf3352e.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/12.81e5ed02.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/13.13ba422c.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/14.e628666c.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/15.110671ae.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/16.340c8491.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/17.dfac54fd.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/2.e2bca5e2.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/3.4a7a99d1.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/4.0b9e0af5.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/6.9c95efb4.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/7.76d085cb.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/8.193980ce.js"><link rel="prefetch" href="/EmbeddedFPSExample/assets/js/9.13b3fcb5.js">
    <link rel="stylesheet" href="/EmbeddedFPSExample/assets/css/0.styles.7db95943.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/EmbeddedFPSExample/" class="home-link router-link-active"><!----> <span class="site-name">EmbeddedFPSExample</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/EmbeddedFPSExample/guide/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/EmbeddedFPSExample/guide/setting-up-the-projects.html" class="sidebar-link">Setting up the projects</a></li><li><a href="/EmbeddedFPSExample/guide/client-basics-and-login-system-part-1.html" class="active sidebar-link">Client Basics and Login System part 1</a></li><li><a href="/EmbeddedFPSExample/guide/server-basics-and-login-system.html" class="sidebar-link">Server Basics and Login System</a></li><li><a href="/EmbeddedFPSExample/guide/room-system-part-1-server-side.html" class="sidebar-link">Room System part 1 (Server-side)</a></li><li><a href="/EmbeddedFPSExample/guide/client-login-system-part-2-and-lobby.html" class="sidebar-link">Client Login System part 2 and Lobby</a></li><li><a href="/EmbeddedFPSExample/guide/room-system-part-2-server-side.html" class="sidebar-link">Room System part 2 (Server-side)</a></li><li><a href="/EmbeddedFPSExample/guide/player-movement-interpolation-and-client-side-prediction.html" class="sidebar-link">Player-Movement, Interpolation and Client Side Prediction</a></li><li><a href="/EmbeddedFPSExample/guide/multiplayer-gameplay.html" class="sidebar-link">Multiplayer Gameplay (Synchronization,-Buffers)</a></li><li><a href="/EmbeddedFPSExample/guide/reconciliation.html" class="sidebar-link">Reconciliation</a></li><li><a href="/EmbeddedFPSExample/guide/health-shooting-lag-Compensation.html" class="sidebar-link">Health, Shooting, Lag Compensation</a></li><li><a href="/EmbeddedFPSExample/guide/networking-discussion.html" class="sidebar-link">Networking Discussion</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="client-basics-and-login-system-part-1"><a href="#client-basics-and-login-system-part-1" aria-hidden="true" class="header-anchor">#</a> Client Basics and Login System part 1</h1> <p>We will start by implementing functionality to connect to a server and send a simple login request. Let's create a script that connects our client to a server.</p> <ul><li>In the client project create a &quot;GlobalManager&quot; script in the Scripts folder</li> <li>In the main scene create an empty Gameobject and name it &quot;GlobalScripts&quot;</li> <li>Add a UnityClient component to that gameobject (you need to search for just &quot;client&quot; when adding the component)</li> <li>Set the values of the UnityClient like this:<br> <img src="https://i.imgur.com/gxPD6tI.png" alt><br> <strong>Important:</strong> Set Auto Connect to false we will connect in the GlobalManager!</li></ul> <p>Now we will implement the GlobalManager. First of all add the GlobalManager as a component to the GlobalScripts gameobject. Then open the GlobalManager in your favorite IDE or editor. (Mine is Rider)<br>
We want the GlobalManager to be globally accessible and present in all scenes so we add the following code:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">;</span>
<span class="token keyword">using</span> DarkRift<span class="token punctuation">;</span>
<span class="token keyword">using</span> DarkRift<span class="token punctuation">.</span>Client<span class="token punctuation">.</span>Unity<span class="token punctuation">;</span>
<span class="token keyword">using</span> UnityEngine<span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token class-name">RequireComponent</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>UnityClient<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalManager</span> <span class="token punctuation">:</span> <span class="token class-name">MonoBehaviour</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">GlobalManager</span> Instance<span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token function">DontDestroyOnLoad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>This allows us to access GlobalManager from any script by calling GlobalManager.Instance, it will also keep the gameobject, where GlobalManager is attached to, loaded when we swap it. We also make sure that we don't create 2 GlobalManagers somehow.</p> <p>The next step is creating a connection to a server. There are two ways of connecting to a Darkrift server. ConnectInBackGround() and Connect().</p> <ul><li>Connect() will connect to the server and freeze everything until it's connected or failed the connect. You can run code immediately after, to check if the connection worked (it runs synchronously).</li> <li>ConnectInBackGround() connects asynchronously to the server so your code will continue to run and players won't experience a screen freeze. It will invoke a void function of your choice with an exeception parameter as soon as it connected or when the connection failed.</li></ul> <p>We will use ConnectInBackGround because we don't want our clients to freeze for a few seconds after starting up. (In a real application you would also want to display an animated connection screen for the users)</p> <p>We will add some variables and a way to ConnectInBackGround to our GlobalManager.
Add the following to the GlobalManager script:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>   <span class="token punctuation">[</span><span class="token class-name">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Variables&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token keyword">public</span> <span class="token keyword">string</span> IpAdress<span class="token punctuation">;</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> Port<span class="token punctuation">;</span>

   <span class="token punctuation">[</span><span class="token class-name">Header</span><span class="token punctuation">(</span><span class="token string">&quot;References&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   <span class="token keyword">public</span> <span class="token class-name">UnityClient</span> Client<span class="token punctuation">;</span>
</code></pre></div><p>And also the following connection code:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
       Client<span class="token punctuation">.</span><span class="token function">ConnectInBackground</span><span class="token punctuation">(</span>IPAddress<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>IpAdress<span class="token punctuation">)</span><span class="token punctuation">,</span>Port<span class="token punctuation">,</span> IPVersion<span class="token punctuation">.</span>IPv4<span class="token punctuation">,</span> ConnectCallback<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ConnectCallback</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Client<span class="token punctuation">.</span>Connected<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//here we will add login code later</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>This code tries to connect to a server when we start unity and as soon as we are connected it will call the ConnectCallback function. The function checks if we are connected or if the connection failed and if the connection failed it just tries to connect again by calling Start();
This is everything needed to connect to a Darkrift server.</p> <p>Now lets create a simple login interface.
We will only use a username and no password or account management in our login system to keep it simple.</p> <ul><li>Create a &quot;LoginManager&quot; script in the Scripts folder</li> <li>Create a &quot;LoginManager&quot; GameObject in the Main scene.</li> <li>Add the LoginManager as a component to the LoginManager Gameobject.</li> <li>Create a Canvas and add a Window(UI Image),scale it up to the screen size and then add a Button and a InputField to the window, your scene should look now like this:<br> <img src="https://i.imgur.com/zgiTrVo.png" alt></li></ul> <p>Now open the LoginManager and again create a static reference to itself and some references to the login elements</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code> <span class="token keyword">using</span> System<span class="token punctuation">;</span>
    <span class="token keyword">using</span> DarkRift<span class="token punctuation">;</span>
    <span class="token keyword">using</span> DarkRift<span class="token punctuation">.</span>Client<span class="token punctuation">;</span>
    <span class="token keyword">using</span> UnityEngine<span class="token punctuation">;</span>
    <span class="token keyword">using</span> UnityEngine<span class="token punctuation">.</span>UI<span class="token punctuation">;</span>
	
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">LoginManager</span> Instance<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token class-name">Header</span><span class="token punctuation">(</span><span class="token string">&quot;References&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> LoginWindow<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">InputField</span> NameInput<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Button</span> SubmitLoginButton<span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>It would be nice if the login window only appeared once we connected to the server so lets hide it:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        LoginWindow<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>And create a function to activate it:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">StartLoginProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        LoginWindow<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Unlike in the GlobalManager we don't have to check if Instance != null and delete the script if another already exists because there will always only be one LoginManager because it gets destroyed when we load another scene.</p> <p>In the GlobalManager we can start now the login process once the client is connected:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Client<span class="token punctuation">.</span>Connected<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        LoginManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">StartLoginProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Now we can code our first message that we send to the server, but first we have to create a new script.</p> <ul><li>Create a Networking Data script in the Scripts/shared folder.</li> <li>Open it and remove everything that unity created.</li></ul> <p>Darkrift uses tags to identify messages. A tag is a ushort value(0 to 65,535). We could try to remember all tags but people tend to be better at remembering words so we will use a c# feature to convert our tags into a human readable format.</p> <p>Add the following to the Networking Data script</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> Tags
<span class="token punctuation">{</span>
    LoginRequest <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    LoginRequestAccepted <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    LoginRequestDenied <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This allows us to use Tags.LoginRequest  as a tag which is easy to remember.
We created 3 tags. LoginRequest is the tag for a message that a client sends to the server when he wants to login.
LoginRequestAccepted and LoginRequestDenied are answers from the server.</p> <p>But we have to send additional data to the server to login. In our case we just send a username but in most cases you would additionally also send a password.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Never send passwords without encryption, you have to use an encryption library to send messages with important information.</p></div> <p>When we send data to a server we have to serialize it (create a bunch of bytes out of our things that we want to send).
Darkrift does that part for us. We can use a writer to serialize data like this. (Don't write this anywhere its just an example)</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">DarkriftWriter</span> writer <span class="token operator">=</span> DarkriftWriter<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//writes an int value of 5 to the writer</span>
writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">ushort</span><span class="token punctuation">)</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// writes a ushort value.</span>
</code></pre></div><p>You can also write strings and floats and arrays to a writer. A writer is then used to create a message. A message wants a tag and a writer to send, in its constructor.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">Message</span> message <span class="token operator">=</span> Message<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can the send a message by accessing a UnityClient and calling</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code> UnityClient<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> sendmode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>There are 2 send modes in Darkrift SendMode.Reliable and SendMode.Unreliable. We will just use reliable for now and will come back to this point later.</p> <p>On the server when we receive a message we can read values out of the message by creating a DarkriftReader:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token class-name">DarkriftReader</span> reader <span class="token operator">=</span> Message<span class="token punctuation">.</span><span class="token function">GetReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function">readInt32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//reads an int</span>
reader<span class="token punctuation">.</span><span class="token function">readuint32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//reads an ushort</span>
reader<span class="token punctuation">.</span><span class="token function">ReadString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//reads a string</span>
reader<span class="token punctuation">.</span><span class="token function">ReadSingle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//reads a float</span>
</code></pre></div><p>Readers, Writers and Messages should be disposed after using them so call Reader.Dispose() after using them. you can also use using blocks and achieve the same effect for example sending a message correctly looks like this:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span><span class="token punctuation">(</span><span class="token class-name">DarkriftWriter</span> writer <span class="token operator">=</span> DarkriftWriter<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;this is a test message.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         UnityClient<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> SendMode<span class="token punctuation">.</span>Reliable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It is very important that you always read and write the same amount of data. But doing this the way above leaves room for a lot of mistakes and you will end up with a lot of read and write.</p> <p>It would be nice to have a way to abstract that process right? Darkrift has a neat system to do that, IDarkriftSerializables. So instead of using writers and reader we will create a IDarkriftSerializable in our Networking Data class:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">struct</span> LoginRequestData <span class="token punctuation">:</span> IDarkRiftSerializable
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> Name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">LoginRequestData</span><span class="token punctuation">(</span><span class="token keyword">string</span> name<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Deserialize</span><span class="token punctuation">(</span><span class="token class-name">DeserializeEvent</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Name <span class="token operator">=</span> e<span class="token punctuation">.</span>Reader<span class="token punctuation">.</span><span class="token function">ReadString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Serialize</span><span class="token punctuation">(</span><span class="token class-name">SerializeEvent</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>Writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The LoginRequestData contains data in the form of a string Name and a function Deserialize and Serialize.
These two functions are called when Darkrift sends a message. e.Writer.Write(Name) will &quot;add&quot; the name string to the message when we send it and e.Reader.ReadString(); will read it on the server side and recreate the LoginRequestData. As you can see reading and writing still works in a similar way. But debugging this will be much easier because you can check easily if the serialization of LoginData is correct or wrong. to now send a IDarkriftSerializable you can just put it into a message instead of a writer.</p> <p>So lets add a function to the LoginManager to send a message:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">OnSubmitLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>NameInput<span class="token punctuation">.</span>text <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            LoginWindow<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">Message</span> m <span class="token operator">=</span> Message<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">ushort</span><span class="token punctuation">)</span>Tags<span class="token punctuation">.</span>LoginRequest<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LoginRequestData</span><span class="token punctuation">(</span>NameInput<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                GlobalManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>Client<span class="token punctuation">.</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> SendMode<span class="token punctuation">.</span>Reliable<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>This function will deactivate the login window and then send a message to the server with the tag LoginRequest (= 0) and data in the form of a LoginRequestData which contains the name entered in the input field. The (ushort) in front of Tags.LoginRequest tells C# to convert LoginRequest back into an actual number.\</p> <p>Finally lets subscribe our login button to that function. To do that add the following in the Start() function:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>SubmitLoginButton<span class="token punctuation">.</span>onClick<span class="token punctuation">.</span><span class="token function">AddListener</span><span class="token punctuation">(</span>OnSubmitLogin<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The scripts should now look like this:</p> <ul><li><a href="https://pastebin.com/3ikzDGmU" target="_blank" rel="noopener noreferrer">GlobalManager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://pastebin.com/CzNWwC0T" target="_blank" rel="noopener noreferrer">LoginManager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://pastebin.com/AUwDCCZc" target="_blank" rel="noopener noreferrer">Networking Data<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Now lets jump to the to the server side...</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/EmbeddedFPSExample/guide/setting-up-the-projects.html" class="prev">
          Setting up the projects
        </a></span> <span class="next"><a href="/EmbeddedFPSExample/guide/server-basics-and-login-system.html">
          Server Basics and Login System
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/EmbeddedFPSExample/assets/js/app.c192a5b8.js" defer></script><script src="/EmbeddedFPSExample/assets/js/5.8d4560b8.js" defer></script>
  </body>
</html>
